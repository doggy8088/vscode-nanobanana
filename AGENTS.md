# Repository Guidelines

## Project Structure & Module Organization
- `src/extension.ts`: extension entrypoint; registers VS Code commands and UI flows.
- `src/services/`: integration and domain logic (Gemini API, Copilot prompt generation, file output, model/style helpers).
- `src/i18n.ts`: runtime localization messages; keep keys aligned with `package.nls*.json`.
- `tests/*.test.ts`: Vitest unit tests for services and helpers.
- `scripts/publish-vscode.ps1`: automated Marketplace publish script.
- `docs/`: publishing and operational documentation.
- `dist/`: bundled extension output (generated by build).

## Build, Test, and Development Commands
- `npm run build`: bundle extension into `dist/extension.js` using esbuild.
- `npm run watch`: rebuild automatically while developing.
- `npm run typecheck`: run strict TypeScript checks (`tsc --noEmit`).
- `npm run test`: execute Vitest test suite.
- `npm run package:vsix`: create installable VSIX (also rewrites README image base URL).
- `npm run publish:vscode`: run the PowerShell publish workflow.

## Coding Style & Naming Conventions
- Language: TypeScript (`strict: true` in `tsconfig.json`).
- Indentation: 2 spaces; keep imports grouped and sorted logically.
- Naming: `camelCase` for variables/functions, `PascalCase` for types/classes, `UPPER_SNAKE_CASE` for constants.
- Keep command/config IDs stable (e.g., `nanoBanana.*`) and define shared keys in `src/constants.ts`.
- For user-facing text, add/update i18n keys instead of hardcoding strings.

## Testing Guidelines
- Framework: Vitest.
- Test files: `tests/<module>.test.ts`.
- Add tests for every behavior change in `src/services/*` and pure helper logic.
- Run `npm run typecheck && npm run test` before opening a PR.
- Validate by running `npm run typecheck`, `npm run test`, `npm run build`, and `npm run package:vsix`.

## Commit & Pull Request Guidelines
- Follow Conventional Commit style seen in history: `feat: ...`, `feat(scope): ...`, `fix: ...`, `docs: ...`.
- Keep commits focused and atomic; avoid mixing refactor + feature work.
- PRs should include:
  - clear summary and motivation,
  - linked issue/task (if available),
  - screenshots or GIFs for command/menu/webview UI changes,
  - notes on config/i18n updates (`package.nls*.json`, `src/i18n.ts`, README).

## Security & Configuration Notes
- Never commit API keys or tokens.
- Gemini key must be stored via VS Code SecretStorage through the extension command, not in files.
- Validate new settings defaults in `package.json` and mirror behavior in runtime config parsing.
